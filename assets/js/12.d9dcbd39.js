(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{227:function(n,a,t){"use strict";t.r(a);var s=t(39),r=Object(s.a)({},(function(){var n=this,a=n.$createElement,t=n._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h2",{attrs:{id:"å‰è¨€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[n._v("#")]),n._v(" å‰è¨€")]),n._v(" "),t("p",[n._v("yarn@1.11 ç‰ˆæœ¬ä¸­å¼•å…¥äº† -pnp å‚æ•°ï¼Œå®£å‘Šå½»åº•æŠ›å¼ƒ node_modules çš„ä¸€ç§è§£å†³æ–¹æ¡ˆ ğŸ˜ ï¼Œpnp = Plug'n'Play = Plug and Playï¼Œæ„ä¸ºå¯æ’æ‹”çš„æ„æ€ï¼Œæ˜¯ yarn åœ¨18å¹´11æœˆä»½æ—¶æ¥å—çš„"),t("a",{attrs:{href:"https://github.com/yarnpkg/rfcs/pull/101",target:"_blank",rel:"noopener noreferrer"}},[n._v("101å· RFC ææ¡ˆ"),t("OutboundLink")],1),n._v("ï¼Œç›®çš„åœ¨äºè§£å†³å®‰è£…ä¾èµ–çš„è€—æ—¶ç“¶é¢ˆï¼Œç³»ç»Ÿçš„ I/O æ—¶é—´ï¼Œæˆ‘ä»¬çŸ¥é“æ— è®ºæ˜¯ npm è¿˜æ˜¯ yarn äº¦æˆ–æ˜¯å…¶ä»–çš„åŒ…ç®¡ç†å·¥å…·ï¼Œéƒ½å…·å¤‡ç¼“å­˜çš„åŠŸèƒ½ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å®‰è£…ä¾èµ–æ—¶ï¼Œå…¶å®æ˜¯å°†ç¼“å­˜ä¸­çš„ç›¸å…³åŒ…å¤åˆ¶åˆ°é¡¹ç›®ç›®å½•ä¸­ node_modules é‡Œã€‚ yarn -pnp çš„æœ¬è´¨å°±æ˜¯ä¸ºäº†ä¼˜åŒ–è¿™å…³é”®çš„ä¸€æ­¥æ“ä½œï¼Œåœ¨è¯¦ç»†ä»‹ç»ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸‹ç¤¾åŒºå…¶ä»–çš„è§£å†³æ–¹æ¡ˆã€‚")]),n._v(" "),t("h2",{attrs:{id:"pnpm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pnpm"}},[n._v("#")]),n._v(" pnpm")]),n._v(" "),t("p",[t("a",{attrs:{href:"https://pnpm.js.org/",target:"_blank",rel:"noopener noreferrer"}},[n._v("pnpm"),t("OutboundLink")],1),n._v(" é€šè¿‡ Hard linksï¼ˆç¡¬é“¾æ¥ï¼‰ å’Œ symlinksï¼ˆç¬¦å·é“¾æ¥ï¼‰ ç¡®ä¿æ¯ä¸ªä¸åŒçš„åŒ…åœ¨ä½ çš„ç”µè„‘ä¸Šåªä¼šæœ‰ä¸€ä¸ªï¼Œä¸ä¼šå ç”¨é¢å¤–çš„å­˜å‚¨ç©ºé—´ã€‚ Hard links ç›¸å½“äºæºæ–‡ä»¶çš„å‰¯æœ¬ï¼Œä½†ä¸å ç”¨ä»»ä½•ç©ºé—´ï¼Œsysmlink å¯ä»¥ç†è§£ä¸ºå¿«æ·æ–¹å¼ã€‚ä½†è¿™ç§æ–¹å¼ä»ç„¶æœ‰ä¸€äº›é—®é¢˜ï¼Œæ”¹å˜ç¡¬é“¾æ¥çš„æ–‡ä»¶ï¼Œç›¸å½“äºå¯¹æºæ–‡ä»¶è¿›è¡Œæ”¹å˜ï¼Œå¯èƒ½ä¼šå½±å“åˆ°å…¶ä»–ä½¿ç”¨è¿™ä¸ªæºæ–‡ä»¶ç¼“å­˜çš„é¡¹ç›®ï¼Œå¦å¤– Node.js ä¹Ÿæ— æ³•çŸ¥é“ä¾èµ–æ˜¯å¦é€šè¿‡å…¶ä»–æ–¹å¼æ¯”å¦‚ yarn link åˆ›å»ºäº†ç¬¦å·é“¾æ¥ã€‚å¯¹è·¨ä¸åŒæ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚ NTFS ä¸ FAT32 äº’ç›¸æ“ä½œï¼Œæ— æ³•åˆ›å»ºç¡¬é“¾æ¥ã€‚æœ€é‡è¦çš„ï¼Œpnpm å¹¶æœªå‡å°‘ç³»ç»Ÿ I/O æ“ä½œå¸¦æ¥çš„æ—¶é—´ã€‚")]),n._v(" "),t("h2",{attrs:{id:"tink"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tink"}},[n._v("#")]),n._v(" tink")]),n._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/npm/tink",target:"_blank",rel:"noopener noreferrer"}},[n._v("tink"),t("OutboundLink")],1),n._v(" å’Œ pnp å·®ä¸å¤šåŒæ—¶æ¨å‡ºçš„è§£å†³æ–¹æ¡ˆï¼Œå·ç§°ä¸‹ä¸€ä»£åŒ…ç®¡ç†å™¨ï¼Œæ–°å¢äº† package-map.json æ˜ å°„ä¾èµ–å¯¹åº”çš„å…¨å±€ç¼“å­˜ä¸­çš„è·¯å¾„ï¼Œä½†å¦‚ README æ‰€è¯´ï¼Œç›®å‰ä»ç„¶å¤„äºå¼€å‘é˜¶æ®µï¼Œä¸å»ºè®®å¤§å®¶ä½¿ç”¨ã€‚ç²—ç•¥çš„çœ‹ä¸‹æºç ï¼Œå…¶æ€æƒ³æ˜¯å¯¹ Node.js çš„ä¸€äº›ç³»ç»Ÿå±‚é¢çš„ API å¦‚ fs, child_process, module ç­‰æ¨¡å—è¿›è¡Œäº† override çš„æ“ä½œï¼Œè¿™æ ·å†å¯»æ‰¾ä¾èµ–æ—¶ä¼šéµå¾ª tink åˆ¶å®šçš„è§„èŒƒã€‚")]),n._v(" "),t("h2",{attrs:{id:"pnp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pnp"}},[n._v("#")]),n._v(" pnp")]),n._v(" "),t("p",[n._v("pnp å‡ºç°çš„åŸå› ä¸»è¦æœ‰ä¸¤ç‚¹ï¼Œç¬¬ä¸€ï¼Œå½“æˆ‘ä»¬ require ä¸€ä¸ªä¾èµ–æ—¶ï¼ŒNode.js åªæ˜¯ç®€å•çš„é€’å½’å»å¯»æ‰¾ node_modules ä¸­å¯¹åº”çš„åŒ…ï¼Œç›´åˆ°æ‰¾åˆ°åŒ¹é…çš„åŒ…ï¼Œå¦‚æœæœªæ‰¾åˆ°ä¹Ÿä¸ä¼šç«‹åˆ»æŠ›å‡ºå¼‚å¸¸ï¼Œåªåœ¨è¿è¡Œæ—¶æ‰ä¼šå‘ç°ã€‚ç¬¬äºŒï¼Œæ˜¯å¼€ç¯‡ä¸€ç›´æåˆ°çš„ï¼Œä»ç¼“å­˜ä¸­å¤åˆ¶ä¾èµ–åˆ°é¡¹ç›®ä¸­çš„ node_modules çš„ I/O è€—æ—¶éš¾ä»¥ä¼˜åŒ–ã€‚pnpçš„è§£å†³æ–¹æ¡ˆæ˜¯å½»åº•æŠ›å¼ƒäº†node_modulesï¼Œé€šè¿‡ä¸€ä¸ªç‰¹æ®Šçš„æ¨¡å—è§£æ resolverï¼Œå°† require çš„ä¾èµ–ï¼ŒæŒ‡å‘å…¨å±€ç¼“å­˜ä¸­å¯¹åº”çš„åŒ…ï¼Œè¿™æ ·å¯ä»¥ç›´æ¥ç•¥è¿‡ I/O æ“ä½œï¼Œå‡å°‘å®‰è£…ä¾èµ–çš„è€—æ—¶ã€‚")]),n._v(" "),t("p",[n._v("æ·±å…¥å­¦ä¹ ä¸‹ pnp è¯¦ç»†çš„åšæ³•ï¼Œåœ¨æ‰§è¡Œ yarn -pnp æ—¶ï¼Œä¼šç”Ÿæˆ .pnp.js çš„æ–‡ä»¶ï¼Œä¸¾ä¸ªæ —å­ï¼Œæˆ‘ä»¬ä¾èµ– lodash ï¼Œ.pnp.js é‡Œä¼šç”Ÿæˆå…³äº lodash çš„æ˜ å°„å…³ç³»ï¼Œå¦‚ä¸‹å›¾ï¼Œå°†ä¾èµ–è·¯å¾„æ˜ å°„åˆ°å…¨å±€çš„ç›®å½•ä¸‹ã€‚\n"),t("img",{attrs:{src:"http://img.lastwhisper.cn/pnp-map.png",alt:"pnp-map"}})]),n._v(" "),t("p",[n._v("ä½†åœ¨å®é™…ä½¿ç”¨æ—¶éœ€è¦ preload .pnp.js æ–‡ä»¶ ã€‚")]),n._v(" "),t("div",{staticClass:"language-javascript extra-class"},[t("pre",{pre:!0,attrs:{class:"language-javascript"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[n._v("// test.js")]),n._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[n._v("const")]),n._v(" lodash "),t("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[n._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[n._v("'lodash'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[n._v("node -r ./.pnp.js test.js\n")])])]),t("p",[n._v("å› ä¸ºè¿™ä¸ªæ–‡ä»¶å¯¹ Node.js çš„ Module æ¨¡å—åšäº† monkey patchï¼Œä¿®æ”¹äº†å¦‚ _load, _resolve , _findPath ç­‰æ–¹æ³•ç­‰æ¥å®ç°å®ƒç‰¹æ®Šçš„ä¾èµ– resolverï¼Œæƒ³äº†è§£æ›´å¤šçš„è¯ï¼Œç›´æ¥ yarn -pnp åˆ°ç”Ÿæˆçš„æ–‡ä»¶é‡Œçœ‹çœ‹ç©¶ç«Ÿï¼Œä½†ç›®å‰è¿™ä¸ªæœºåˆ¶è¿˜æ˜¯æœ‰äº›å¯ä»¥å†æ”¹è¿›çš„ç»†èŠ‚ï¼Œæ¯”å¦‚æ˜ å°„å…³ç³»æ˜¯ä¸æ˜¯ç”¨ç±»ä¼¼ webpack çš„ manifest æ–‡ä»¶æ¥è¡¨ç¤ºæ›´å¥½ï¼Œåœ¨ yarnrfc é‡Œå·²æœ‰è¿™ä¸ªææ¡ˆï¼Œå¸Œæœ›ä¸ä¹…çš„å°†æ¥å¯ä»¥å®ç°ã€‚")]),n._v(" "),t("p",[n._v("åœ¨æ»¡ç¼“å­˜çš„æƒ…å†µä¸‹å¯¹æ™®é€šçš„ yarn å’Œ yarn -pnp åšä¸€æ¬¡ benchmarkã€‚")]),n._v(" "),t("p",[t("img",{attrs:{src:"http://img.lastwhisper.cn/yarn-normal.png",alt:"yarn-normal"}}),n._v(" "),t("img",{attrs:{src:"http://img.lastwhisper.cn/yarn-pnp.png",alt:"pnp"}})]),n._v(" "),t("p",[n._v("æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ˜¾è‘—çš„å®‰è£…æ—¶é—´å‡å°‘ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œåœ¨æœªå®‰è£…ä¸€äº›ä¾èµ–æ—¶ä¹Ÿæ— éœ€ç­‰åˆ°è¿è¡Œæ—¶æ‰ä¼šå‘ç°ï¼Œé¢„åŠ è½½ .pnp.js æ—¶ä¼šç›´æ¥æŠ›é”™æç¤ºå¼€å‘è€…ã€‚è™½ç„¶å»å¹´11æœˆ Facebook å†…éƒ¨å·²ç»å¼€å§‹ä½¿ç”¨äº† pnp å¹¶ä¸”æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†ä»ç„¶ä¸æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ã€‚CI ç³»ç»Ÿä¸Šå¯ä»¥å…ˆè¡Œè¯•ç”¨ï¼Œå¯ä»¥æå¤§çš„å‡å°‘å®‰è£…ä¾èµ–çš„æ—¶é—´ã€‚")]),n._v(" "),t("p",[n._v("Yarn Plug'n'Play is future. Let's wait and see ! ğŸº")])])}),[],!1,null,null,null);a.default=r.exports}}]);