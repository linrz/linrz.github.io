(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{416:function(r,a,e){"use strict";e.r(a);var t=e(40),s=Object(t.a)({},function(){var r=this,a=r.$createElement,e=r._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":r.$parent.slotKey}},[e("p",[r._v("Node.js 生态中，最喜欢的包管理器还是 yarn 了，\byarn 的核心\b开发者 arcanis 在一月份时提出了对 yarn 文来的展望，有一些很有意思的 Feature，\b可以窥见 yarn 的野心。")]),r._v(" "),e("h2",{attrs:{id:"plugin-system"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#plugin-system","aria-hidden":"true"}},[r._v("#")]),r._v(" Plugin system")]),r._v(" "),e("p",[r._v("yarn \b会提供插件化的系统支持，在 resolution/fetch/link 等步骤中可以运行\b插件的业务逻辑，举个栗子，"),e("code",[r._v("yarn@berry")]),r._v(" 内置的 "),e("a",{attrs:{href:"https://github.com/yarnpkg/berry/tree/master/packages/plugin-github",target:"_blank",rel:"noopener noreferrer"}},[r._v("plugin-github"),e("OutboundLink")],1),r._v(" 支持 github 的地址，类似 "),e("code",[r._v("https://github.com/${username}/${reponame}/archive/${branch}.tar.gz")]),r._v(" 作为依赖，当然也支持任意的 url，plugin-http 会帮我们完成依赖的下载安装解析等步骤。")]),r._v(" "),e("h2",{attrs:{id:"cli"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cli","aria-hidden":"true"}},[r._v("#")]),r._v(" CLI")]),r._v(" "),e("p",[r._v("由于上文提到的插件化，yarn \b不在是一个单纯的包管理器，不需要解析 package.json，可以引用 yarn 中相关的 api 完成一些操作，笔者暂未做过实验，这里暂不讨论具体用法。")]),r._v(" "),e("h2",{attrs:{id:"lockfile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#lockfile","aria-hidden":"true"}},[r._v("#")]),r._v(" Lockfile")]),r._v(" "),e("p",[r._v("yarn.lock 的格式会\b改成 YAML 格式的子集，并且会把 resolved 原来的绝对路径替换成相对的，这对开发者切换 registry 更加友好。")]),r._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[r._v('wrappy@1:\n  version "1.0.2"\n  resolved "https://registry.yarnpkg.com/wrappy/-/wrappy-1.0.2.tgz#b5243d8f3ec1aa35f1364605bc0d1036e30ab69f"\n\nwrappy@1:\n  version "1.0.2"\n  resolved "/wrappy/-/wrappy-1.0.2.tgz#b5243d8f3ec1aa35f1364605bc0d1036e30ab69f"\n')])])]),e("h2",{attrs:{id:"flow-typescript"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#flow-typescript","aria-hidden":"true"}},[r._v("#")]),r._v(" Flow => TypeScript")]),r._v(" "),e("p",[r._v("Flow 再次惨遭亲爹抛弃，"),e("code",[r._v("yarn@berry")]),r._v(" \b用 \btypecript 进行了重写，这会对第三方的维护者更加友好。")]),r._v(" "),e("h2",{attrs:{id:"scripts-underlying-system"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#scripts-underlying-system","aria-hidden":"true"}},[r._v("#")]),r._v(" Scripts underlying system")]),r._v(" "),e("p",[r._v("不需要在 \b\bpackage.json 的 scripts 中使用类似 cross_env 的命令了，yarn 会默认使用一个轻量级的支持 POSIX 标准的\b shell。")]),r._v(" "),e("h2",{attrs:{id:"tar-zip"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tar-zip","aria-hidden":"true"}},[r._v("#")]),r._v(" \b\bTar => Zip")]),r._v(" "),e("p",[r._v("缓存文件的格式从 tar 切换成 zip，zip 的随机访问速度会更快，另外\b笔者猜测可能是减少下缓存文件大小的体积，毕竟用 tar 打出来的文件是比原来大小要大的，zip 会有 toc 更方便，随机访问 zip 包中的某个文件夹只需要在 toc 中找到存放的文字，直接跳过去即可。")]),r._v(" "),e("h2",{attrs:{id:"better-for-monorepo"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#better-for-monorepo","aria-hidden":"true"}},[r._v("#")]),r._v(" Better for monorepo")]),r._v(" "),e("p",[r._v("run / add 相关的命令不再不需 cd 到一个个子 package \b目录下执行。")]),r._v(" "),e("h2",{attrs:{id:"more"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#more","aria-hidden":"true"}},[r._v("#")]),r._v(" More")]),r._v(" "),e("p",[r._v("可以戳"),e("a",{attrs:{href:"https://github.com/yarnpkg/yarn/issues/6953",target:"_blank",rel:"noopener noreferrer"}},[r._v("这里"),e("OutboundLink")],1),r._v("阅读 arcanis 在 issue 区讨论的原文\b。")]),r._v(" "),e("h2",{attrs:{id:"how-to-try-yarn-berry"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#how-to-try-yarn-berry","aria-hidden":"true"}},[r._v("#")]),r._v(" How to try yarn@berry")]),r._v(" "),e("ol",[e("li",[r._v("升级 yarn@1.15，这个版本加入了 berry 的 policy")]),r._v(" "),e("li",[r._v("打开你的\b一个项目")]),r._v(" "),e("li",[e("code",[r._v("yarn policies set-version nightly")])]),r._v(" "),e("li",[e("code",[r._v("yarn policies set-version berry")]),r._v("  🛬")])]),r._v(" "),e("p",[r._v("如果想恢复到 yarn v1，把项目根目录下生成的 .yarnrc 文件删除即可。\nLet's try berry ! 😎")])])},[],!1,null,null,null);a.default=s.exports}}]);