<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>为什么身边的同学不喜欢写页面单测 | linrz</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.317bd212.css" as="style"><link rel="preload" href="/assets/js/app.1e5ad27b.js" as="script"><link rel="preload" href="/assets/js/3.f7b3f5da.js" as="script"><link rel="preload" href="/assets/js/1.e1ad31da.js" as="script"><link rel="preload" href="/assets/js/10.608077d7.js" as="script"><link rel="preload" href="/assets/js/5.1c548fdf.js" as="script"><link rel="prefetch" href="/assets/js/11.ef2c5c54.js"><link rel="prefetch" href="/assets/js/12.52cf1c53.js"><link rel="prefetch" href="/assets/js/13.7706ffad.js"><link rel="prefetch" href="/assets/js/14.b81f346d.js"><link rel="prefetch" href="/assets/js/4.61bf351f.js"><link rel="prefetch" href="/assets/js/6.6cb7d486.js"><link rel="prefetch" href="/assets/js/7.e0c57542.js"><link rel="prefetch" href="/assets/js/8.92050c65.js"><link rel="prefetch" href="/assets/js/9.7380e416.js">
    <link rel="stylesheet" href="/assets/css/0.styles.317bd212.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="cute-nav"><div class="cute-nav-left"><a href="/">linrz</a></div> <div class="cute-nav-right"><div class="cute-nav-item cute-nav-active"><a href="/">Blog</a></div><div class="cute-nav-item "><a href="/about">About</a></div></div></div> <div class="cute-content"><div class="cute-page-header"><div class="cute-page-title">为什么身边的同学不喜欢写页面单测</div> <div class="cute-page-subtitle"><span class="cute-page-date">04/03 2019</span> <span>☕️</span> <span>5 min read</span></div></div> <div class="cute-page-markdown"><div slot="default" class="markdown-body content default"><p>最近遇到了工作以来最难推动的事儿，前端各个应用开始补齐单测，开年回来开始做这件事儿，到现在约一个半月，十个应用代码的行覆盖率平均才到了30%，采取的模式是 Jest + Enzyme，写过的同学应该都知道只是渲染一下，覆盖率已经可以达到一小半了。尽管在行动前已经沟通过需要按核心用例去写，但这一个半月的补齐单测的行动大多数都是判断渲染是否成功的单测，运行起来味如嚼蜡，毫无意义。</p> <p>回过头来思考一下为什么大家不喜欢写页面的单测呢 🤔，笔者从自身出发列了下面几点：</p> <h5 id="缺少专门的写单测时间，相当于压缩业余时间干更多的事情"><a href="#缺少专门的写单测时间，相当于压缩业余时间干更多的事情" aria-hidden="true" class="header-anchor">#</a> 缺少专门的写单测时间，相当于压缩业余时间干更多的事情</h5> <p>当你在承受较高的需求吞吐率的时，假设是瀑布流的开发模式，一个项目刚进入提测阶段，可能另一个项目的评审已经开始了，没有硬性要求覆盖率达到阈值才允许发布的情况下，鲜有开发同学会挤时间去些单测，有这时间，为什么不闭目养神歇一会儿呢。</p> <h5 id="没有得到开发同学发自心底的认可，看不见短期的回报"><a href="#没有得到开发同学发自心底的认可，看不见短期的回报" aria-hidden="true" class="header-anchor">#</a> 没有得到开发同学发自心底的认可，看不见短期的回报</h5> <p>由于一直是零单元测试的生态，改动了什么地方，会不会影响到其他地方，纯粹靠人的经验。大部分开发同学没有尝到依赖单元测试避免线上问题的甜头，与其为可能屎一样的老代码写单测，还不如学点其他东西，看下业界最新动态呢。</p> <h5 id="页面改动频繁，增加维护成本"><a href="#页面改动频繁，增加维护成本" aria-hidden="true" class="header-anchor">#</a> 页面改动频繁，增加维护成本</h5> <p>没有单测前，改个需求，修个 bug，超起键盘一把梭子验证好就上线，有了后可能导致单测挂掉，需要同步修改，还需要等待 Jenkins 的 CI 执行报告，拖沓了节奏。</p> <h5 id="大团队的自驱力不够，期望和重视程度没有高度对齐"><a href="#大团队的自驱力不够，期望和重视程度没有高度对齐" aria-hidden="true" class="header-anchor">#</a> 大团队的自驱力不够，期望和重视程度没有高度对齐</h5> <p>一个优秀的技术产品，大多数是六七个人的小团队做出来的，自驱力和执行力极高。人多会导致需要规范各种流程甚至编码风格，需要增加交流沟通成本等等。做事情很难只是靠一句话一个通知就可以达到预期的效果，甚至需要一些手段去催促去检验结果。如果将补齐单测这件事情和绩效挂钩，大家加班补齐也会完成目标，但无疑会破坏团队的氛围，是极其不可取的。</p> <p>所以，为了拿到补齐单测的结果，如何去解决上面的问题呢 🤔</p> <ul><li><p>和 PM 团队沟通，项目开发需要加上前端单测的估时，排期时不要忽略这部分工作量的时间，倒排及特殊情况再商议。</p></li> <li><p>和测试团队沟通，各种日常发布，项目发布把关下是否补齐了单测，发出测试也在注重这件事情的信号，具体的阈值等观察一段时间后再定下来。</p></li> <li><p>集成单测相关的动作到 pre-commit, pre-push 的 hooks 中，包括发布单时标注此次的 CI 报告。流程又臭又长是为了保证规范和减少犯错，这是无可避免的，培养开发同学去习惯去适应。</p></li> <li><p>提高团队自驱力和执行力较难，是个长期的过程，目前可行方案还是先带动一小批个人自我驱动较强的同学，再慢慢辐射影响到周边。</p></li></ul></div></div></div> <div class="cute-footer cute-content"><div class="cute-footer-copyright">
    © linrz Themed By <a target="_blank" href="https://github.com/linrz/vuepress-theme-cute">vuepress-theme-cute</a></div> <div class="cute-footer-hills"></div></div></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1e5ad27b.js" defer></script><script src="/assets/js/3.f7b3f5da.js" defer></script><script src="/assets/js/1.e1ad31da.js" defer></script><script src="/assets/js/10.608077d7.js" defer></script><script src="/assets/js/5.1c548fdf.js" defer></script>
  </body>
</html>
